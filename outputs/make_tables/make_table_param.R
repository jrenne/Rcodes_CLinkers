# ===============================================================
# Prepare tex table for parameters

# Define format of figures:
nb.dec <- 2 # number of decimal numbers
format.nb  <- paste("%.",nb.dec,"f",sep="")
format.nb0 <- paste("%.",0,"f",sep="")
format.nb5 <- paste("%.",5,"f",sep="")


latex.table <- rbind(
  paste("Time step &",
        "$\\Delta t $ &",
        "&",
        make.entry(model_sol$tstep,format.nb),
        "& &",
        "",
        "\\\\",sep=""),
  paste("Risk aversion &",
        "$\\gamma$ &",
        "\\eqref{eq:logU}&",
        make.entry(model_sol$parameters$gamma,format.nb),
        "& &",
        "",
        "\\\\",sep=""),
  paste("Discount factor &",
        "$\\delta $ &",
        "\\eqref{eq:logU}&",
        make.entry(model_sol$parameters$delta,format.nb),
        "& &",
        "",
        "\\\\",sep=""),
  paste("Capital depreciation rate &",
        "dep &",
        "\\eqref{eq:newDeltac}&",
        make.entry(model_sol$parameters$delta_K,format.nb),
        "& &",
        "",
        "\\\\",sep=""),
  paste("Mean carbon concentration over 2020-2100 &",
        "$\\bar{M}_{AT}$ &",
        "$m_{0}$&",
        "1160",
        "&GtC &",
        "RCP4.5+RCP6.0",
        "\\\\",sep=""),
  paste("Preindustrial carbon concentration in the atm.&",
        "$M_{PI}$ &",
        "($m_{0}$)+\\eqref{eq:radforcAppendix}&",
        make.entry(model_sol$parameters$m_pi,format.nb),
        "&GtC &",
        "CDICE",
        "\\\\",sep=""),
  paste("Correction parameter in RF linearization &",
        "$m_{0} $ &",
        "\\eqref{eq:Flog}+\\eqref{eq:radforcAppendix}&",
        "$\\frac{\\bar{M}_{AT}}{M_{PI}}$=",
        make.entry(model_sol$parameters$m0,format.nb),
        "&&",
        "CDICE+RCP",
        "\\\\",sep=""),
  paste("Decline rate of decarbonization &",
        "$\\delta{\\sigma} $ &",
        "\\eqref{eq:carboIntensity}&",
        make.entry(model_sol$parameters$delsigma,format.nb5),
        "&per period &",
        "DICE2016",
        "\\\\",sep=""),
  paste("Industrial emissions in 2015 &",
        "$e_0 $ &",
        "($\\sigma_0$)+($E_{ind,0}$) &",
        make.entry(model_sol$parameters$e0,format.nb),
        "&GtCO$_2$ per year&",
        "CDICE",
        "\\\\",sep=""),
  paste("Initial world gross output in 2015 &",
        "$q_0 $ &",
        "($\\sigma_0$)+\\eqref{eq:IndAppendix}&",
        make.entry(model_sol$parameters$q0,format.nb),
        "&trillions of 2010 USD&",
        "DICE2016",
        "\\\\",sep=""),
  paste("Initial emission control rate in 2015 &",
        "$\\mu_0 $ &",
        "($\\sigma_0$)+\\eqref{eq:muAppendix}&",
        make.entry(model_sol$parameters$mu0,format.nb),
        "&&",
        "",
        "\\\\",sep=""),
  paste("Carbon intensity in 2015 &",
        "$\\sigma_{0} $ &",
        "\\eqref{eq:carboIntensity}&",
        "$\\frac{e_0}{q_0 (1-\\mu_0 )}=$",
        make.entry(model_sol$parameters$sigma0,format.nb),
        "&kgCO$_2$ per output 2005 USD 2010 &",
        "DICE2016",
        "\\\\",sep=""),
  paste("Initial growth of carbon intensity $\\sigma_1$ &",
        "$g_{\\sigma,1} $ &",
        "\\eqref{eq:carboIntensity}&",
        make.entry(model_sol$parameters$gsigma1,format.nb5),
        "&per year &",
        "DICE2016",
        "\\\\",sep=""),
  paste("Initial cost decline backstop cost &",
        "$gback $ &",
        "\\eqref{eq:bckstopAppendix}&",
        make.entry(model_sol$parameters$gback,format.nb5),
        "&per period&",
        "DICE2016",
        "\\\\",sep=""),
  paste("Exponent control cost function &",
        "$\\theta_2 $ &",
        "\\eqref{eq:adjBackstopAppendix}+\\eqref{eq:adjLambdatAppendix}&",
        make.entry(model_sol$parameters$theta2,format.nb),
        "&&",
        "DICE2016",
        "\\\\",sep=""),
  paste("Carbon emissions from land in 2015 &",
        "$\\varepsilon_0 $ &",
        "\\eqref{eq:declineLand}&",
        make.entry(model_sol$parameters$eps_0,format.nb),
        "&GTCO$_2$ per year &",
        "DICE2016",
        "\\\\",sep=""),
  paste("Decline rate in land emissions &",
        "$\\rho $ &",
        "\\eqref{eq:declineLand}&",
        make.entry(model_sol$parameters$rho,format.nb5),
        "&per period&",
        "DICE2016",
        "\\\\",sep=""),
  paste("2015 forcings of non-CO$_2$ GHG &",
        "$\\phi_0 $ &",
        "\\eqref{eq:exogradforcingAppendix}&",
        make.entry(model_sol$parameters$phi_0,format.nb),
        "&W/m$^2$&",
        "DICE2016",
        "\\\\",sep=""),
  paste("2100 forcings of non-CO$_2$ GHG &",
        "$\\phi_1 $ &",
        "\\eqref{eq:exogradforcingAppendix}&",
        make.entry(model_sol$parameters$phi_1,format.nb),
        "&W/m$^2$&",
        "DICE2016",
        "\\\\",sep=""),
  paste("Equilibrium concentration in atmosphere &",
        "$mateq $ &",
        "\\eqref{eq:carboncycleAppendix}&",
        make.entry(model_sol$parameters$mateq,format.nb),
        "&GtC &",
        "CDICE",
        "\\\\",sep=""),
  paste("Equilibrium concentration in upper strata &",
        "$mueq $ &",
        "\\eqref{eq:carboncycleAppendix}&",
        make.entry(model_sol$parameters$mueq,format.nb),
        "&GtC &",
        "CDICE",
        "\\\\",sep=""),
  paste("Equilibrium concentration in lower strata &",
        "$mleq $ &",
        "\\eqref{eq:carboncycleAppendix}&",
        make.entry(model_sol$parameters$mleq,format.nb),
        "&GtC &",
        "CDICE",
        "\\\\",sep=""),
  paste("Transfer coef. from atm. to up. ocean reservoirs &",
        "$\\varphi_{12} $ &",
        "\\eqref{eq:carboncycleAppendix}&",
        make.entry(model_sol$parameters$varphi_12,format.nb5),
        "&&",
        "CDICE",
        "\\\\",sep=""),
  paste("Transfer coef. from up. to lo. ocean reservoirs &",
        "$\\varphi_{23} $ &",
        "\\eqref{eq:carboncycleAppendix}&",
        make.entry(model_sol$parameters$varphi_23,format.nb5),
        "&&",
        "CDICE",
        "\\\\",sep=""),
  paste("Climate equation coefficient for upper level &",
        "$\\xi_1 $ &",
        "\\eqref{eq:TatAppendix}&",
        make.entry(model_sol$parameters$xi_1,format.nb5),
        "&per period&",
        "CDICE",
        "\\\\",sep=""),
  paste("Transfer coef. upper to lower stratum &",
        "$\\xi_2 $ &",
        "\\eqref{eq:TatAppendix}&",
        make.entry(model_sol$parameters$xi_2,format.nb5),
        "&per period &",
        "CDICE",
        "\\\\",sep=""),
  paste("Transfer coef. for lower stratum &",
        "$\\xi_3 $ &",
        "\\eqref{eq:TloAppendix}&",
        make.entry(model_sol$parameters$xi_3,format.nb5),
        "&per period&",
        "CDICE",
        "\\\\",sep=""),
  paste("Forcings of equilibrium CO$_2$ doubling &",
        "$\\tau $ &",
        "\\eqref{eq:radforcAppendix}+\\eqref{eq:TatAppendix}&",
        make.entry(model_sol$parameters$tau,format.nb),
        "&W/m$^2$&",
        "CDICE",
        "\\\\",sep=""),
  paste("Equilibrium temperature impact &",
        "$\\nu $ &",
        "\\eqref{eq:TatAppendix}&",
        "3.25",
        "&\\degree C per doubling CO$_2$&",
        "CDICE",
        "\\\\",sep=""),
  paste("Persistence RF shock &",
        "$\\Phi_{[2,2]} $ &",
        "\\eqref{eq:eta}&",
        make.entry(model_sol$parameters$Phi[2,2],format.nb),
        "&&",
        "",
        "\\\\",sep=""),
  paste("Coef. attached to $\\Delta T_{at,t}$ &",
        "$b_{SAT} $ &",
        "\\eqref{eq:SeaLAppendix}&",
        make.entry(model_sol$parameters$b_sat,format.nb5),
        "&m per \\degree C&",
        "\\citet{Vermeer_Rahmstorf_2009}",
        "\\\\",sep=""),
  paste("Base temperature for sea level equilibrium &",
        "$T_{0,S} $ &",
        "\\eqref{eq:SeaLAppendix}&",
        make.entry(model_sol$parameters$T_0s,format.nb5),
        "& per \\degree C&",
        "\\citet{Vermeer_Rahmstorf_2009}",
        "\\\\",sep=""),
  paste("Destruction of capital due to rising sea level&",
        "$b_{SK} $ &",
        "\\eqref{eq:newDeltac}&",
        make.entry(model_sol$parameters$b_sk,format.nb5),
        "& &",
        "\\citet{Hinkel_etal_2014}",
        "\\\\",sep="")
  )
latex.file <- paste("outputs/Tables/table_param.txt",sep="")

write(latex.table, file = latex.file)

# paste(" &",
#       "$ $ &",
#       "\\eqref{eq:}&",
#       make.entry(model_sol$parameters$,format.nb),
#       "&",
#       "",
#       "\\\\",sep="")